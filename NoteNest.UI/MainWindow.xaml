<Window x:Class="NoteNest.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:controls="clr-namespace:NoteNest.UI.Controls"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="NoteNest" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        MinHeight="500" MinWidth="800"
        Closing="Window_Closing">
    
    <!-- Option 1: Remove ExtendViewIntoTitleBar for standard menu behavior -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Standard Menu Bar (not in title bar) -->
        <Menu Grid.Row="0" VerticalAlignment="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_New Note" InputGestureText="Ctrl+N" Click="NewNoteMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Add"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="New _Category" Click="NewCategoryMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="NewFolder"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Convert Notes _Format..." Click="ConvertNotesFormatMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Refresh"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Open" InputGestureText="Ctrl+O">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="OpenFile"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Save" InputGestureText="Ctrl+S" Click="SaveMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Save"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save _All" InputGestureText="Ctrl+Shift+S" Click="SaveAllMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="SaveLocal"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="_Settings" InputGestureText="Ctrl+," Click="SettingsMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Setting"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="E_xit" InputGestureText="Alt+F4" Click="ExitMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Cancel"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            
            <MenuItem Header="_Edit">
                <MenuItem Header="_Undo" InputGestureText="Ctrl+Z" Command="ApplicationCommands.Undo">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Undo"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Redo" InputGestureText="Ctrl+Y" Command="ApplicationCommands.Redo">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Redo"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Cu_t" InputGestureText="Ctrl+X" Command="ApplicationCommands.Cut">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Cut"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Copy" InputGestureText="Ctrl+C" Command="ApplicationCommands.Copy">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Copy"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Paste" InputGestureText="Ctrl+V" Command="ApplicationCommands.Paste">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Paste"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="_Find" InputGestureText="Ctrl+F" Click="FindMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Find"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Replace" InputGestureText="Ctrl+H" Click="ReplaceMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Refresh"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            
            <MenuItem Header="_View">
                <MenuItem Header="_Theme">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Setting"/>
                    </MenuItem.Icon>
                    <MenuItem Header="_Light" Name="LightThemeMenuItem" Click="LightTheme_Click" IsCheckable="True"/>
                    <MenuItem Header="_Dark" Name="DarkThemeMenuItem" Click="DarkTheme_Click" IsCheckable="True"/>
                    <MenuItem Header="_System" Name="SystemThemeMenuItem" Click="SystemTheme_Click" IsCheckable="True" IsChecked="True"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Show _Activity Bar" Name="ShowActivityBarMenuItem" IsCheckable="True" Click="ShowActivityBarMenuItem_Click"/>
            </MenuItem>
            
            <MenuItem Header="_Help">
                <MenuItem Header="_Documentation" Click="DocumentationMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Help"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_About" Click="AboutMenuItem_Click">
                    <MenuItem.Icon>
                        <ui:SymbolIcon Symbol="Help"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>
        
        <!-- Main Layout with optional Activity Bar -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Activity Bar: visibility bound in code-behind to settings -->
            <controls:ActivityBar x:Name="ActivityBarControl"
                                  Grid.Column="0"
                                  Visibility="Collapsed"/>

            <!-- Main Panel -->
            <controls:NoteNestPanel Grid.Column="1" x:Name="MainPanel" />

            <!-- Splitter between main content and plugin panel -->
            <GridSplitter Grid.Column="2"
                          HorizontalAlignment="Left"
                          Width="3"
                          Background="Transparent"
                          Visibility="Collapsed"
                          x:Name="PluginSplitter"/>

            <!-- Plugin Panel Host -->
            <ContentControl Grid.Column="2"
                            x:Name="PluginPanelHost"
                            Width="300"
                            Visibility="Collapsed"/>
        </Grid>
    </Grid>
</Window>